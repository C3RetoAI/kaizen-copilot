{
  "repo": {
    "name": "Adobe-Consulting-Services/acs-aem-commons",
    "buggy_commit": "a2cf90935d6166680ad85a9ac045e5060bf202ac",
    "fixed_commit": "be4c5995f48fb4b25d56d6b20485d28d62d76479"
  },
  "input": {
    "language": "Java",
    "issue": {
      "issue_title": "Reduce usage of Apache Commons Lang 2",
      "issue_description": "\r\nApache commons lang 2 is not maintained anymore since years. Usage of it should be replaced with Apache Commons Lang 3. Both libraries are part of AEM as a Cloud Service and AEM 6.x, only a change of the imports is required.\r\n\r\nThere is one exception, the usage of AEMs MailTemplate API which currently does not provide an alternative. Once that is available we can change the last remaining usage of Apache commons lang 2.\r\n\r\n\r\n\r\n"
    },
    "buggy_commit_message": "Merge branch 'Adobe-Consulting-Services:master' into master",
    "buggy_file": {
      "buggy_filename": "bundle/src/main/java/com/adobe/acs/commons/analysis/jcrchecksum/impl/options/ChecksumGeneratorOptionsFactory.java",
      "buggy_code": "/*\n * ACS AEM Commons\n *\n * Copyright (C) 2013 - 2023 Adobe\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\npackage com.adobe.acs.commons.analysis.jcrchecksum.impl.options;\n\nimport com.adobe.acs.commons.analysis.jcrchecksum.ChecksumGeneratorOptions;\nimport org.apache.commons.lang.StringUtils;\nimport org.apache.sling.api.SlingHttpServletRequest;\n\nimport java.io.IOException;\n\npublic class ChecksumGeneratorOptionsFactory {\n\n    private ChecksumGeneratorOptionsFactory() {\n        // Private cstor\n    }\n\n    public static ChecksumGeneratorOptions getOptions(SlingHttpServletRequest request, String name) throws IOException {\n        if (StringUtils.equalsIgnoreCase(\"REQUEST\", name)) {\n            return new RequestChecksumGeneratorOptions(request);\n        } else {\n            return new DefaultChecksumGeneratorOptions(request);\n        }\n    }\n}\n"
    },
    "context": [
      {
        "filename": "bundle/src/main/java/com/adobe/acs/commons/analysis/jcrchecksum/ChecksumGeneratorOptions.java",
        "code": "/*\n * ACS AEM Commons\n *\n * Copyright (C) 2013 - 2023 Adobe\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\npackage com.adobe.acs.commons.analysis.jcrchecksum;\n\nimport org.osgi.annotation.versioning.ProviderType;\n\nimport java.util.Collections;\nimport java.util.Set;\n\n@ProviderType\n@SuppressWarnings(\"squid:S1214\")\npublic interface ChecksumGeneratorOptions {\n    String DATA = \"data\";\n\n    String PATHS = \"paths\";\n\n    String QUERY = \"query\";\n\n    String QUERY_TYPE = \"queryType\";\n\n    String NODES_TYPES = \"nodeTypes\";\n\n    String NODE_TYPE_EXCLUDES = \"excludeNodeTypes\";\n\n    String PROPERTY_EXCLUDES = \"excludeProperties\";\n\n    String SORTED_PROPERTIES = \"sortedProperties\";\n\n    String SUB_TREE_EXCLUDES = \"excludeSubTrees\";\n\n    String NODE_NAME_EXCLUDES = \"excludeNodeNames\";\n\n    /**\n     * For a node to be checksumable, its primaryType must exists in getIncludedNodesTypes() and not exist in\n     * getExcludedNodeTypes().\n     * @return the nodes types which are candidates for aggregation.\n     */\n    Set<String> getIncludedNodeTypes();\n\n    /**\n     * @return the node types which are not candidates for aggregation and cannot be aggregated under aggregation\n     * candidates.\n     */\n    Set<String> getExcludedNodeTypes();\n\n    /**\n     *\n     * @return the property names that should not be included as part of the checksum hash\n     */\n    Set<String> getExcludedProperties();\n\n    /**\n     * @return the property names whose multi-value order as defined in the JCR should be respected.\n     */\n    Set<String> getSortedProperties();\n\n    /**\n     * @return the named node subTrees to exclude (the matching node and any sub-nodes will NOT be traversed/checksumed)\n     */\n    default Set<String> getExcludedSubTrees() {\n        return  Collections.EMPTY_SET;\n    }\n\n    /**\n     * @return the nodeNames to exclude (sub-nodes WILL be traverse/checksumed)\n     */\n    default Set<String> getExcludedNodeNames() {\n        return  Collections.EMPTY_SET;\n    }\n}"
      }
    ],
    "unresolved_context": [
      "org.apache.commons.lang.StringUtils",
      "org.apache.sling.api.SlingHttpServletRequest",
      "java.io.IOException"
    ]
  },
  "output": {
    "language": "Java",
    "fixed_commit_message": "Reduce usage of Apache Commons Lang 2\nThis fixes #3408",
    "fixed_file": {
      "fixed_filename": "bundle/src/main/java/com/adobe/acs/commons/analysis/jcrchecksum/impl/options/ChecksumGeneratorOptionsFactory.java",
      "fixed_code": "/*\n * ACS AEM Commons\n *\n * Copyright (C) 2013 - 2023 Adobe\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\npackage com.adobe.acs.commons.analysis.jcrchecksum.impl.options;\n\nimport com.adobe.acs.commons.analysis.jcrchecksum.ChecksumGeneratorOptions;\nimport org.apache.commons.lang3.StringUtils;\nimport org.apache.sling.api.SlingHttpServletRequest;\n\nimport java.io.IOException;\n\npublic class ChecksumGeneratorOptionsFactory {\n\n    private ChecksumGeneratorOptionsFactory() {\n        // Private cstor\n    }\n\n    public static ChecksumGeneratorOptions getOptions(SlingHttpServletRequest request, String name) throws IOException {\n        if (StringUtils.equalsIgnoreCase(\"REQUEST\", name)) {\n            return new RequestChecksumGeneratorOptions(request);\n        } else {\n            return new DefaultChecksumGeneratorOptions(request);\n        }\n    }\n}\n"
    },
    "context": [
      {
        "filename": "bundle/src/main/java/com/adobe/acs/commons/analysis/jcrchecksum/ChecksumGeneratorOptions.java",
        "code": "/*\n * ACS AEM Commons\n *\n * Copyright (C) 2013 - 2023 Adobe\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\npackage com.adobe.acs.commons.analysis.jcrchecksum;\n\nimport org.osgi.annotation.versioning.ProviderType;\n\nimport java.util.Collections;\nimport java.util.Set;\n\n@ProviderType\n@SuppressWarnings(\"squid:S1214\")\npublic interface ChecksumGeneratorOptions {\n    String DATA = \"data\";\n\n    String PATHS = \"paths\";\n\n    String QUERY = \"query\";\n\n    String QUERY_TYPE = \"queryType\";\n\n    String NODES_TYPES = \"nodeTypes\";\n\n    String NODE_TYPE_EXCLUDES = \"excludeNodeTypes\";\n\n    String PROPERTY_EXCLUDES = \"excludeProperties\";\n\n    String SORTED_PROPERTIES = \"sortedProperties\";\n\n    String SUB_TREE_EXCLUDES = \"excludeSubTrees\";\n\n    String NODE_NAME_EXCLUDES = \"excludeNodeNames\";\n\n    /**\n     * For a node to be checksumable, its primaryType must exists in getIncludedNodesTypes() and not exist in\n     * getExcludedNodeTypes().\n     * @return the nodes types which are candidates for aggregation.\n     */\n    Set<String> getIncludedNodeTypes();\n\n    /**\n     * @return the node types which are not candidates for aggregation and cannot be aggregated under aggregation\n     * candidates.\n     */\n    Set<String> getExcludedNodeTypes();\n\n    /**\n     *\n     * @return the property names that should not be included as part of the checksum hash\n     */\n    Set<String> getExcludedProperties();\n\n    /**\n     * @return the property names whose multi-value order as defined in the JCR should be respected.\n     */\n    Set<String> getSortedProperties();\n\n    /**\n     * @return the named node subTrees to exclude (the matching node and any sub-nodes will NOT be traversed/checksumed)\n     */\n    default Set<String> getExcludedSubTrees() {\n        return  Collections.EMPTY_SET;\n    }\n\n    /**\n     * @return the nodeNames to exclude (sub-nodes WILL be traverse/checksumed)\n     */\n    default Set<String> getExcludedNodeNames() {\n        return  Collections.EMPTY_SET;\n    }\n}"
      }
    ],
    "unresolved_context": [
      "org.apache.commons.lang3.StringUtils",
      "org.apache.sling.api.SlingHttpServletRequest",
      "java.io.IOException"
    ],
    "changes_summary": "Code changed as follows:\n--- buggy\n+++ fixed\n@@ -19,7 +19,7 @@\n package com.adobe.acs.commons.analysis.jcrchecksum.impl.options;\n \n import com.adobe.acs.commons.analysis.jcrchecksum.ChecksumGeneratorOptions;\n-import org.apache.commons.lang.StringUtils;\n+import org.apache.commons.lang3.StringUtils;\n import org.apache.sling.api.SlingHttpServletRequest;\n \n import java.io.IOException;"
  }
}